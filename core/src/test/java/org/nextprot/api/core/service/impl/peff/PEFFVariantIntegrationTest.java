package org.nextprot.api.core.service.impl.peff;

import org.junit.Assert;
import org.junit.Test;
import org.nextprot.api.core.domain.annotation.Annotation;
import org.nextprot.api.core.service.AnnotationService;
import org.nextprot.api.core.test.base.CoreUnitBaseTest;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ActiveProfiles;

import java.util.List;
import java.util.stream.Collectors;


@ActiveProfiles({ "dev", "cache" })
public class PEFFVariantIntegrationTest extends CoreUnitBaseTest {

    @Autowired
    private AnnotationService annotationService;

    @Test
    public void formatSimpleVariant() {

        List<Annotation> isoformAnnotations = annotationService.findAnnotations("NX_P43246").stream()
                .filter(annotation -> annotation.isSpecificForIsoform("NX_P43246-1"))
                .collect(Collectors.toList());

        PEFFVariantSimple variantSimple = new PEFFVariantSimple("NX_P43246-1", isoformAnnotations);

        String actualFormat = variantSimple.format();
        String expectedFormat = "\\VariantSimple=(1|L)(2|E)(2|T)(2|V)(3|L)(3|M)(4|*)(4|H)(4|K)(4|L)(4|P)(5|L)(5|Q)(5|R)(6|E)(6|N)(7|A)(7|G)(7|K)(7|Q)(8|M)(8|R)(8|S)(10|*)(10|H)(10|K)(12|A)(12|D)(12|Q)(13|I)(13|N)(13|R)(14|T)(15|G)(15|T)(16|A)(16|D)(17|F)(17|G)(17|I)(17|L)(18|D)(19|L)(19|S)(19|V)(20|M)(21|C)(21|G)(21|H)(21|L)(22|I)(22|L)(23|L)(24|*)(24|E)(24|H)(25|C)(25|D)(25|S)(26|L)(26|V)(27|L)(27|R)(27|S)(27|T)(28|*)(28|K)(29|*)(30|L)(30|Q)(30|R)(30|T)(31|I)(31|S)(32|N)(32|P)(32|S)(33|A)(33|I)(33|P)(34|M)(35|C)(35|G)(35|H)(35|L)(36|V)(37|L)(38|E)(38|Y)(39|P)(39|Q)(39|W)(40|D)(40|S)(40|V)(41|E)(41|Y)(42|L)(43|*)(43|C)(43|D)(43|F)(43|H)(44|K)(44|M)(45|S)(45|V)(46|P)(46|Q)(46|Y)(47|R)(47|S)(48|*)(48|D)(49|E)(49|V)(49|Y)(50|E)(50|G)(50|P)(50|S)(50|V)(52|M)(52|P)(52|V)(53|G)(53|S)(53|T)(53|V)(54|S)(54|T)(54|V)(55|G)(55|Q)(56|*)(56|K)(56|Q)(56|V)(57|G)(58|L)(58|S)(59|*)(59|E)(59|M)(59|N)(59|R)(61|*)(61|E)(61|H)(61|L)(61|P)(62|A)(62|E)(62|R)(63|E)(63|L)(63|M)(64|M)(64|V)(65|E)(67|I)(67|K)(67|V)(68|A)(69|L)(69|R)(69|S)(70|E)(70|T)(70|V)(71|E)(71|R)(71|V)(72|G)(72|T)(73|*)(73|E)(73|R)(74|H)(74|I)(74|K)(76|*)(76|E)(76|H)(76|P)(77|C)(77|I)(77|R)(78|I)(81|I)(81|N)(81|T)(82|*)(82|N)(83|L)(83|V)(86|Q)(87|C)(87|Y)(89|A)(89|I)(89|L)(91|H)(91|V)(92|F)(92|H)(92|I)(92|V)(93|F)(94|V)(95|L)(96|C)(96|H)(97|*)(97|H)(97|K)(97|P)(98|*)(98|C)(98|F)(99|K)(99|S)(101|*)(102|I)(103|C)(103|F)(103|H)(104|*)(104|N)(104|T)(105|S)(106|G)(106|I)(106|K)(106|T)(107|D)(107|G)(107|P)(107|V)(108|E)(108|V)(109|D)(109|I)(109|S)(110|*)(110|N)(110|Q)(110|T)(111|T)(112|C)(112|F)(113|K)(113|N)(114|*)(115|K)(115|Y)(116|V)(117|*)(117|G)(117|L)(117|S)(118|*)(118|C)(121|*)(121|C)(121|N)(121|S)(122|E)(122|M)(122|Q)(123|G)(123|T)(123|V)(124|C)(125|L)(125|S)(125|T)(126|R)(126|S)(127|I)(127|S)(127|T)(128|R)(128|V)(129|C)(129|F)(129|P)(130|*)(130|H)(131|V)(132|V)(133|G)(135|F)(135|V)(136|L)(137|R)(138|D)(138|S)(139|S)(140|Y)(141|T)(141|V)(142|*)(142|A)(143|G)(143|S)(143|T)(144|C)(145|M)(145|T)(145|V)(146|R)(146|V)(147|G)(147|I)(148|A)(148|E)(149|A)(149|D)(150|I)(151|E)(151|T)(153|C)(153|F)(154|P)(154|S)(154|T)(154|V)(155|A)(155|D)(155|G)(155|I)(157|A)(157|V)(158|*)(159|I)(160|*)(160|H)(160|K)(161|A)(161|D)(161|I)(161|L)(162|A)(162|R)(163|A)(163|D)(163|G)(164|E)(164|R)(164|W)(165|*)(165|C)(165|D)(167|E)(167|H)(168|C)(168|F)(169|M)(169|T)(169|V)(170|*)(170|E)(170|R)(171|K)(171|M)(172|R)(173|P)(173|R)(173|V)(174|E)(175|P)(176|F)(177|*)(177|D)(177|G)(177|H)(177|K)(177|V)(178|L)(178|Y)(179|A)(179|L)(180|V)(182|N)(182|Y)(183|*)(183|K)(183|R)(184|L)(185|C)(185|F)(186|D)(186|H)(186|S)(187|F)(187|I)(187|P)(187|R)(187|V)(188|Q)(189|G)(189|S)(189|T)(190|P)(190|V)(191|F)(192|F)(192|M)(193|*)(193|H)(194|T)(196|L)(196|Q)(196|S)(197|E)(197|Q)(198|*)(198|D)(198|G)(198|K)(199|G)(199|R)(199|Y)(200|D)(200|I)(201|*)(202|L)(202|R)(203|*)(203|R)(204|*)(204|A)(204|E)(204|R)(205|*)(205|D)(205|Q)(206|S)(207|S)(207|T)(207|V)(209|Y)(210|I)(210|V)(211|R)(213|Q)(214|G)(214|I)(214|K)(214|T)(215|*)(216|*)(216|L)(216|T)(216|V)(217|V)(218|*)(219|T)(221|R)(222|F)(222|T)(222|V)(223|P)(223|V)(224|M)(225|I)(225|R)(227|G)(227|K)(227|S)(228|E)(229|*)(230|G)(230|V)(231|H)(231|N)(231|Y)(233|C)(234|A)(234|I)(234|R)(234|S)(235|E)(236|E)(236|G)(236|H)(237|V)(238|C)(238|D)(239|*)(239|E)(239|R)(240|A)(240|G)(240|N)(241|F)(241|V)(242|H)(242|K)(242|S)(243|Q)(243|W)(244|S)(245|F)(246|*)(246|E)(246|Q)(246|R)(248|E)(248|N)(248|Q)(248|R)(249|N)(249|R)(249|T)(250|*)(250|E)(250|R)(250|V)(251|K)(252|*)(252|E)(252|H)(252|P)(252|R)(253|I)(253|L)(254|S)(254|Y)(255|G)(255|N)(255|R)(255|T)(256|G)(256|T)(257|I)(258|F)(259|S)(261|I)(261|L)(261|T)(261|V)(262|D)(262|Q)(262|V)(263|H)(263|K)(263|S)(263|T)(264|*)(264|H)(264|R)(265|F)(266|T)(266|V)(268|A)(268|L)(269|*)(269|L)(270|V)(271|C)(271|F)(271|R)(271|Y)(272|T)(272|V)(273|A)(273|I)(274|M)(274|V)(275|T)(277|*)(278|K)(279|F)(279|H)(279|P)(279|V)(281|*)(281|L)(281|P)(281|T)(282|A)(282|E)(282|G)(282|H)(283|G)(283|V)(283|Y)(284|Y)(285|K)(285|S)(287|*)(287|A)(288|*)(288|R)(289|L)(290|*)(290|Q)(291|V)(292|A)(292|P)(292|S)(293|A)(294|C)(295|E)(296|L)(297|G)(297|R)(298|*)(298|H)(298|P)(298|R)(299|*)(299|C)(299|N)(300|I)(300|K)(300|V)(301|*)(302|*)(302|M)(302|S)(303|N)(303|V)(304|T)(304|V)(305|E)(305|T)(305|V)(306|V)(308|T)(309|P)(309|T)(309|V)(310|F)(310|P)(310|R)(310|V)(311|K)(311|S)(312|I)(312|V)(313|L)(313|S)(314|*)(314|H)(314|K)(315|D)(315|V)(316|F)(316|P)(316|Y)(317|A)(317|I)(319|G)(319|N)(319|V)(319|Y)(320|A)(320|I)(320|N)(320|P)(320|S)(321|P)(321|S)(322|D)(322|S)(322|V)(323|C)(323|F)(323|Y)(324|*)(324|P)(324|V)(325|F)(327|T)(327|V)(328|A)(328|P)(328|S)(328|T)(328|V)(329|F)(330|M)(330|P)(331|D)(331|S)(333|R)(333|W)(333|Y)(334|*)(335|I)(335|S)(336|A)(336|S)(336|T)(337|*)(337|E)(337|R)(338|A)(338|E)(338|R)(338|V)(339|*)(339|P)(340|G)(341|F)(341|P)(341|R)(341|V)(342|I)(343|D)(343|K)(344|*)(344|H)(344|K)(345|*)(345|G)(347|N)(348|*)(348|E)(348|H)(348|R)(349|A)(349|L)(349|R)(349|S)(349|T)(350|F)(350|V)(351|I)(351|R)(351|T)(351|V)(352|G)(352|Y)(355|I)(356|K)(356|R)(356|T)(357|A)(357|D)(357|Q)(358|A)(358|D)(358|K)(359|*)(359|I)(359|K)(359|S)(359|T)(360|W)(361|S)(362|*)(362|F)(363|L)(364|K)(364|V)(365|D)(365|G)(365|V)(367|A)(367|I)(367|L)(368|G)(368|V)(370|T)(370|V)(371|*)(371|G)(371|K)(371|Q)(372|V)(373|K)(373|S)(374|*)(374|H)(374|R)(375|I)(375|S)(376|F)(376|S)(377|*)(377|E)(377|R)(378|A)(379|Y)(380|*)(380|S)(380|V)(382|C)(382|G)(382|H)(382|S)(383|*)(383|L)(383|P)(383|Q)(384|L)(385|A)(385|L)(385|S)(386|G)(386|N)(387|F)(387|V)(389|*)(389|L)(389|Q)(390|F)(390|V)(391|D)(391|P)(391|T)(391|V)(392|M)(393|*)(393|M)(393|Q)(394|L)(395|*)(395|R)(396|I)(396|T)(397|*)(397|E)(397|H)(397|R)(398|T)(398|V)(400|K)(402|*)(402|E)(402|H)(402|K)(402|R)(404|F)(405|*)(405|C)(406|*)(406|L)(406|Q)(408|*)(408|C)(408|F)(409|*)(409|E)(409|K)(410|C)(410|V)(411|L)(412|T)(413|*)(413|E)(413|P)(414|P)(414|R)(415|A)(415|R)(415|S)(416|I)(416|S)(416|Y)(417|G)(418|L)(418|M)(418|T)(418|V)(419|*)(419|E)(419|K)(419|R)(420|P)(420|S)(421|M)(421|V)(422|*)(422|K)(423|E)(423|R)(424|Q)(424|R)(424|Y)(425|*)(425|E)(425|K)(426|R)(427|G)(427|N)(428|D)(428|Q)(429|*)(429|P)(430|*)(431|*)(431|S)(434|V)(435|I)(435|L)(437|L)(437|M)(438|I)(439|A)(439|L)(439|S)(439|T)(440|F)(440|P)(441|A)(441|P)(441|S)(442|E)(443|I)(443|P)(443|V)(444|H)(444|L)(445|A)(445|F)(446|E)(446|G)(447|L)(447|S)(448|C)(449|*)(449|N)(449|R)(451|*)(451|R)(452|*)(452|K)(452|V)(453|K)(453|L)(453|T)(454|L)(454|R)(454|T)(454|V)(456|A)(456|I)(457|A)(458|*)(458|S)(459|H)(460|I)(460|T)(460|V)(461|A)(461|G)(462|*)(462|H)(463|M)(464|*)(464|G)(465|S)(466|R)(466|Y)(467|*)(468|L)(469|V)(470|A)(470|E)(470|I)(471|N)(472|A)(472|L)(473|*)(473|L)(475|E)(475|G)(475|V)(477|H)(477|S)(477|Y)(478|F)(479|N)(479|R)(480|G)(481|*)(482|*)(482|G)(482|S)(482|T)(483|*)(484|T)(484|V)(485|I)(485|L)(485|T)(485|V)(486|D)(487|E)(488|V)(489|*)(489|D)(489|K)(490|R)(491|N)(492|I)(492|L)(492|T)(492|V)(493|*)(493|L)(494|*)(494|L)(494|P)(495|A)(495|I)(496|*)(496|S)(497|M)(497|V)(498|N)(499|P)(499|V)(501|K)(501|S)(502|G)(503|F)(503|H)(503|P)(503|V)(504|C)(504|D)(504|R)(504|S)(504|V)(506|E)(506|Y)(507|T)(508|A)(509|*)(510|*)(510|H)(511|M)(513|V)(515|C)(516|G)(516|I)(516|N)(516|T)(517|E)(517|T)(517|V)(518|*)(518|L)(518|P)(519|I)(519|L)(519|Y)(521|*)(521|F)(521|N)(522|*)(522|H)(523|S)(524|C)(524|H)(524|L)(524|P)(525|I)(525|L)(526|I)(526|N)(526|P)(527|S)(528|M)(528|Q)(528|R)(531|N)(532|A)(532|G)(533|H)(533|V)(534|C)(534|G)(534|H)(534|L)(534|P)(534|S)(535|K)(536|I)(536|S)(537|R)(537|T)(538|D)(538|I)(539|L)(540|N)(540|R)(540|T)(541|A)(541|I)(542|A)(543|A)(543|E)(544|M)(544|T)(546|N)(547|S)(547|T)(548|C)(549|F)(549|I)(550|*)(550|E)(550|N)(551|L)(551|Y)(552|A)(552|P)(553|D)(553|Y)(554|C)(554|G)(554|N)(554|R)(554|T)(555|Q)(556|L)(556|S)(556|W)(557|I)(557|S)(558|F)(558|T)(558|Y)(559|*)(559|F)(559|I)(560|I)(561|*)(561|K)(562|*)(562|D)(562|Q)(562|V)(563|N)(564|A)(564|N)(564|S)(565|*)(567|*)(567|E)(567|R)(568|I)(568|R)(569|G)(569|I)(569|K)(570|C)(570|H)(572|A)(572|I)(573|T)(574|*)(575|G)(575|V)(575|Y)(576|P)(577|T)(577|V)(580|*)(580|D)(580|K)(581|V)(583|I)(583|S)(583|T)(584|V)(585|F)(586|*)(587|C)(587|D)(587|R)(587|S)(587|V)(588|*)(588|C)(589|I)(590|D)(591|A)(591|L)(591|T)(592|I)(592|V)(593|*)(593|E)(593|H)(593|L)(594|A)(594|I)(595|F)(595|R)(595|V)(596|H)(596|K)(596|S)(597|A)(597|G)(597|N)(597|V)(598|M)(599|S)(600|G)(600|S)(600|T)(600|V)(601|*)(601|H)(601|R)(602|P)(602|V)(603|E)(603|G)(603|H)(603|N)(603|V)(603|Y)(604|T)(605|A)(605|F)(605|I)(605|L)(606|A)(606|D)(607|G)(609|G)(609|P)(609|S)(609|V)(610|N)(610|Q)(610|Y)(611|E)(611|L)(611|M)(612|*)(613|H)(613|I)(613|Y)(614|A)(614|R)(615|P)(615|V)(616|R)(616|S)(617|A)(617|G)(617|L)(618|L)(619|*)(619|C)(620|I)(621|*)(621|G)(621|L)(621|P)(621|Q)(622|A)(622|L)(622|Q)(622|R)(622|T)(623|G)(623|S)(623|V)(624|S)(624|V)(625|V)(627|E)(627|N)(628|*)(628|A)(628|E)(628|R)(628|V)(629|*)(629|E)(629|R)(630|*)(630|R)(630|V)(631|I)(631|K)(631|S)(632|V)(633|T)(633|V)(634|*)(635|N)(636|D)(636|P)(636|T)(636|V)(637|C)(638|G)(638|S)(639|Q)(639|R)(639|Y)(640|S)(641|G)(641|Y)(642|F)(642|I)(643|K)(645|*)(645|E)(645|H)(646|A)(646|E)(646|G)(647|*)(647|K)(647|Q)(648|N)(648|T)(648|V)(649|T)(649|V)(651|V)(652|A)(652|H)(652|R)(652|T)(653|I)(654|E)(654|Y)(655|I)(656|*)(656|C)(656|H)(656|S)(657|V)(658|G)(658|Q)(659|R)(660|E)(660|G)(661|E)(661|N)(661|R)(662|*)(662|E)(662|H)(663|I)(663|L)(663|V)(664|L)(666|M)(667|V)(668|P)(669|A)(669|C)(669|D)(669|R)(669|S)(669|V)(670|H)(670|L)(670|R)(670|S)(671|D)(671|I)(671|K)(671|S)(671|Y)(672|R)(672|V)(673|R)(674|A)(674|D)(674|R)(674|S)(675|A)(675|E)(676|*)(676|L)(677|A)(677|R)(678|*)(678|C)(678|H)(679|T)(680|*)(680|G)(680|P)(680|Q)(681|*)(681|E)(681|H)(683|A)(683|E)(683|R)(683|V)(683|W)(684|L)(685|M)(685|V)(687|P)(688|I)(688|R)(688|V)(689|P)(689|S)(689|V)(690|E)(690|H)(691|M)(691|T)(692|E)(692|R)(692|V)(692|W)(693|*)(693|R)(693|Y)(694|S)(695|L)(695|M)(696|A)(696|L)(696|S)(697|*)(697|F)(697|R)(697|Y)(699|*)(699|A)(699|L)(699|P)(699|T)(700|E)(700|K)(701|A)(701|G)(701|K)(702|E)(702|G)(702|M)(703|C)(703|Y)(704|T)(704|V)(705|L)(705|M)(706|E)(707|G)(707|S)(707|Y)(708|L)(708|N)(708|T)(708|V)(709|V)(710|D)(710|G)(710|P)(710|S)(710|V)(711|*)(711|L)(711|Q)(713|E)(713|V)(714|V)(715|A)(715|R)(715|S)(717|G)(717|N)(718|*)(718|E)(719|W)(720|E)(720|N)(720|R)(721|*)(722|F)(722|I)(723|C)(723|F)(724|A)(724|K)(724|M)(724|R)(726|I)(726|L)(726|V)(727|P)(727|S)(728|Q)(729|I)(729|V)(731|*)(732|I)(732|S)(733|T)(734|C)(735|V)(736|F)(739|P)(740|A)(740|S)(742|G)(742|N)(743|*)(743|L)(744|*)(744|I)(747|R)(747|T)(747|V)(748|H)(748|N)(748|V)(748|Y)(749|*)(749|G)(749|K)(751|R)(754|A)(754|I)(754|S)(756|A)(756|S)(757|C)(757|D)(757|S)(758|N)(758|Y)(759|*)(759|E)(761|A)(761|R)(761|V)(762|S)(763|T)(763|V)(764|*)(764|C)(764|G)(764|R)(765|T)(765|V)(766|M)(766|V)(767|*)(768|V)(769|H)(770|T)(770|V)(772|R)(773|E)(773|N)(774|F)(774|S)(774|T)(774|V)(776|S)(776|T)(778|*)(779|I)(779|L)(779|V)(780|V)(781|T)(782|A)(783|D)(783|Q)(783|R)(783|Y)(784|C)(784|L)(785|P)(785|R)(785|Y)(786|D)(786|K)(787|R)(787|V)(788|P)(789|G)(789|S)(789|V)(790|W)(791|T)(791|V)(792|I)(792|K)(792|S)(793|E)(793|H)(793|K)(793|P)(793|R)(794|K)(794|L)(795|Q)(796|A)(796|I)(796|P)(796|S)(798|D)(798|K)(798|S)(798|T)(799|K)(800|V)(801|L)(801|P)(803|A)(803|I)(804|T)(805|F)(805|V)(806|I)(806|S)(807|I)(807|N)(807|S)(808|*)(809|*)(809|G)(809|K)(811|*)(811|S)(812|S)(813|I)(813|V)(814|L)(815|H)(816|*)(816|R)(817|M)(819|E)(820|A)(820|C)(820|D)(820|S)(822|*)(822|S)(824|*)(824|E)(825|G)(827|R)(828|S)(829|L)(829|Q)(830|A)(831|V)(832|*)(832|D)(832|K)(832|V)(834|T)(835|D)(835|H)(835|S)(836|I)(836|S)(837|S)(839|D)(839|Q)(839|R)(840|A)(840|I)(841|T)(842|G)(842|V)(843|G)(843|S)(843|Y)(844|P)(845|E)(845|Q)(846|*)(846|R)(848|S)(848|T)(849|R)(849|V)(850|K)(851|I)(851|P)(851|V)(852|D)(852|K)(852|Q)(853|*)(853|A)(853|G)(854|C)(854|Y)(855|*)(855|E)(855|H)(855|R)(856|*)(856|C)(856|F)(856|H)(857|M)(857|V)(858|R)(859|*)(859|A)(859|K)(860|*)(860|L)(861|*)(861|E)(861|L)(861|P)(861|Q)(862|E)(862|R)(862|V)(864|A)(864|G)(864|N)(864|Y)(865|M)(865|T)(865|V)(866|I)(866|V)(868|A)(868|L)(868|S)(869|E)(869|V)(870|G)(870|L)(870|S)(870|V)(871|N)(871|R)(872|R)(872|T)(873|G)(873|S)(874|*)(874|C)(874|D)(876|D)(876|G)(878|D)(878|K)(878|Q)(879|*)(879|K)(879|P)(881|K)(881|Q)(882|T)(883|M)(883|T)(884|F)(884|S)(884|T)(885|*)(885|H)(886|*)(886|G)(886|K)(886|Q)(887|L)(889|F)(890|*)(891|G)(894|L)(894|R)(894|T)(895|L)(895|R)(895|S)(896|L)(896|V)(898|A)(898|D)(899|I)(900|*)(902|D)(902|G)(903|S)(903|Y)(904|F)(904|V)(905|I)(905|R)(906|M)(906|R)(906|T)(906|V)(909|E)(909|I)(909|Q)(909|R)(910|E)(910|K)(910|R)(911|P)(911|R)(912|E)(912|Q)(913|G)(914|*)(914|G)(915|A)(915|G)(915|L)(916|L)(917|P)(917|T)(917|V)(918|N)(920|D)(921|N)(922|L)(923|E)(923|L)(924|S)(924|T)(926|M)(926|N)(926|V)(927|L)(928|*)(928|A)(928|P)(929|*)(929|L)(929|Q)(930|K)(930|M)(930|V)(931|E)(931|T)(932|G)(932|I)(933|I)(933|S)(934|A)(934|K)(934|M)(934|S)";
        Assert.assertEquals(expectedFormat, actualFormat);
    }

    @Test
    public void formatComplexVariant() {

        List<Annotation> isoformAnnotations = annotationService.findAnnotations("NX_P43246").stream()
                .filter(annotation -> annotation.isSpecificForIsoform("NX_P43246-1"))
                .collect(Collectors.toList());

        PEFFVariantComplex variantComplex = new PEFFVariantComplex("NX_P43246-1", isoformAnnotations);

        String actualFormat = variantComplex.format();
        String expectedFormat = "\\VariantComplex=(7|7|EAVQPKE)(8|12|KE)(39|41|)(56|61|R)(68|69|M)(92|92|)(94|94|)(101|101|EILHVQ)(101|102|)(149|152|)(157|157|)(188|190|)(191|191|)(209|209|DGD)(217|217|)(247|247|)(265|314|)(344|344|QL)(345|349|S)(411|426|)(417|417|VV)(432|432|)(440|440|)(492|493|I*)(561|562|VL)(566|570|IL)(596|596|)(606|606|)(607|626|)(644|645|E)(649|653|I)(728|733|)(745|746|)(746|746|)(746|746|II)(746|747|)(755|755|SK)(767|768|I)(846|847|)(853|853|)(859|861|G)(865|865|)";
        Assert.assertEquals(expectedFormat, actualFormat);
    }

    /*@Ignore // should not be integration tests, mock deps
    @ActiveProfiles({ "dev" })
    public class PEFFVariantTest {

        @Test
        public void formatSimpleVariant() {

            Entry entry = Mockito.mock(Entry.class);
            Mockito.when(entry.getAnnotationsByIsoform("NX_P43246-1")).thenReturn(new ArrayList<>());

            PEFFVariantSimple variantSimple = new PEFFVariantSimple(entry, "NX_P43246-1");

            String expectedFormat = variantSimple.format();

            Assert.assertEquals("\\VariantSimple=(1|L)(2|E)(2|T)(2|V)(4|*)(4|K)(4|L)(5|L)(5|Q)(6|E)(6|N)(7|A)(8|M)(8|S)(10|*)(10|H)(10|K)(13|I)(13|N)(14|T)(15|G)(16|A)(17|F)(17|G)(17|I)(19|L)(21|G)(21|H)(22|L)(23|L)(24|*)(25|C)(25|D)(25|S)(26|L)(27|L)(27|R)(27|T)(28|*)(28|K)(30|L)(30|Q)(30|R)(30|T)(31|I)(31|S)(32|S)(33|A)(33|I)(33|P)(38|E)(38|Y)(39|P)(40|S)(40|V)(41|E)(41|Y)(42|L)(43|*)(43|C)(43|H)(44|K)(44|M)(45|S)(45|V)(46|Q)(47|R)(48|*)(49|E)(49|V)(50|E)(52|P)(53|S)(54|S)(54|T)(54|V)(55|G)(55|Q)(56|*)(56|K)(56|V)(57|M)(58|L)(59|E)(59|R)(61|*)(61|H)(61|P)(62|A)(62|R)(67|K)(67|V)(70|T)(70|V)(71|R)(72|T)(73|E)(73|N)(74|H)(76|*)(76|E)(76|H)(77|C)(78|I)(81|R)(82|*)(83|L)(84|I)(86|D)(86|Q)(87|C)(89|A)(89|L)(91|V)(92|V)(93|F)(96|C)(96|H)(97|*)(98|C)(99|S)(101|*)(102|I)(103|C)(103|H)(104|N)(106|K)(107|G)(107|P)(109|D)(109|S)(110|Q)(110|R)(110|T)(112|C)(113|K)(114|*)(115|K)(117|S)(121|*)(121|C)(121|N)(122|M)(122|Q)(123|G)(123|T)(123|V)(125|L)(125|S)(126|S)(127|I)(127|S)(128|R)(128|V)(129|C)(129|F)(131|V)(135|F)(135|V)(137|C)(137|R)(138|S)(139|S)(140|Y)(141|T)(141|V)(142|*)(143|T)(144|C)(145|M)(145|T)(145|V)(146|V)(147|G)(147|I)(149|D)(153|C)(154|T)(155|D)(157|A)(158|*)(159|I)(160|*)(161|D)(161|I)(162|A)(162|R)(163|D)(163|G)(164|E)(164|R)(164|W)(165|D)(167|E)(167|H)(168|P)(169|M)(169|V)(170|*)(170|E)(170|L)(171|K)(173|P)(173|R)(174|E)(175|P)(177|*)(177|H)(177|K)(177|V)(182|Y)(183|*)(185|F)(186|D)(186|S)(187|P)(187|R)(187|V)(189|G)(189|S)(189|T)(190|P)(190|V)(192|F)(192|V)(193|*)(194|T)(196|L)(196|S)(197|Q)(198|*)(198|G)(198|K)(199|R)(199|Y)(200|D)(203|R)(204|*)(204|E)(204|R)(205|*)(205|Q)(206|S)(207|S)(207|T)(207|V)(209|Y)(210|I)(211|R)(214|I)(215|*)(216|*)(216|L)(216|T)(216|V)(217|V)(218|*)(219|T)(220|*)(220|V)(221|R)(221|V)(222|F)(222|L)(224|M)(227|G)(227|K)(227|S)(228|E)(229|*)(233|C)(234|I)(235|E)(236|G)(237|V)(239|*)(239|R)(240|G)(242|S)(243|Q)(243|W)(245|F)(246|*)(246|Q)(248|E)(250|*)(250|E)(250|V)(251|K)(252|*)(252|E)(252|H)(252|R)(255|G)(255|N)(255|T)(256|T)(257|I)(258|F)(259|S)(261|L)(261|T)(262|D)(263|H)(263|K)(264|*)(264|H)(264|R)(266|V)(268|A)(268|L)(269|L)(270|V)(271|F)(271|Y)(272|M)(272|V)(273|A)(273|I)(273|K)(274|V)(277|*)(279|V)(281|*)(281|P)(282|G)(282|H)(282|Y)(283|V)(283|Y)(284|Y)(287|*)(287|A)(288|*)(290|*)(291|V)(292|S)(295|E)(296|L)(297|R)(298|*)(298|H)(299|*)(299|H)(300|I)(300|V)(301|*)(302|*)(305|E)(305|T)(308|K)(309|T)(310|P)(310|R)(310|V)(312|V)(313|S)(315|D)(315|V)(316|Y)(319|N)(319|V)(320|A)(321|P)(321|S)(322|D)(322|S)(323|C)(323|F)(323|Y)(324|*)(324|V)(325|F)(328|A)(328|P)(328|S)(328|V)(330|P)(331|D)(331|S)(333|R)(333|Y)(334|*)(335|I)(335|P)(336|A)(336|S)(337|*)(338|E)(338|R)(338|V)(341|P)(341|V)(342|I)(343|D)(344|*)(344|H)(344|K)(345|*)(348|R)(349|A)(349|L)(349|R)(350|F)(351|I)(351|V)(352|H)(353|N)(355|I)(356|T)(357|*)(357|A)(357|D)(357|Q)(358|A)(359|*)(359|I)(359|K)(359|S)(359|T)(361|S)(362|F)(363|L)(367|A)(367|I)(370|V)(371|G)(372|V)(373|K)(374|*)(374|H)(374|R)(375|I)(376|S)(377|*)(377|E)(377|R)(378|A)(379|Y)(380|S)(382|C)(382|H)(383|*)(383|L)(383|P)(383|Q)(385|L)(385|S)(386|E)(387|F)(389|*)(389|Q)(390|F)(391|T)(391|V)(392|M)(393|*)(393|M)(393|Q)(394|L)(395|*)(395|R)(397|*)(397|E)(397|R)(402|*)(402|K)(404|F)(405|*)(406|*)(406|Q)(408|*)(408|C)(408|F)(409|E)(409|K)(410|C)(410|S)(411|L)(412|H)(413|*)(413|P)(414|P)(414|R)(415|A)(415|S)(417|G)(418|L)(418|M)(418|T)(419|*)(419|K)(420|P)(421|M)(421|P)(422|*)(423|E)(423|R)(424|R)(424|Y)(425|E)(426|R)(427|G)(428|Q)(429|*)(430|*)(431|*)(434|V)(435|I)(437|L)(439|L)(439|S)(440|P)(441|P)(443|V)(444|L)(446|E)(447|L)(447|V)(448|C)(449|*)(449|N)(449|R)(451|*)(451|E)(451|R)(452|*)(452|K)(453|K)(454|L)(454|V)(456|A)(456|I)(458|*)(460|I)(460|V)(461|A)(461|G)(461|V)(462|*)(462|H)(464|*)(464|G)(466|R)(466|Y)(467|*)(467|K)(469|F)(469|V)(470|A)(470|E)(471|N)(473|*)(473|L)(476|S)(477|H)(478|F)(479|N)(479|R)(481|*)(482|*)(483|*)(485|I)(485|V)(487|E)(488|V)(489|K)(492|I)(492|L)(492|V)(493|*)(493|L)(494|L)(494|P)(495|A)(495|I)(496|*)(497|V)(498|R)(501|K)(502|G)(502|H)(503|P)(504|C)(504|R)(506|Y)(508|A)(508|S)(509|*)(510|*)(510|H)(516|G)(516|I)(516|N)(516|T)(517|V)(518|*)(518|L)(519|L)(521|F)(522|*)(523|I)(523|S)(524|C)(524|H)(524|L)(524|P)(526|P)(528|M)(528|Q)(528|R)(530|*)(532|A)(532|G)(533|V)(534|C)(534|G)(534|H)(534|L)(534|P)(534|S)(536|S)(537|T)(539|L)(540|G)(541|A)(541|I)(543|N)(544|T)(546|N)(547|S)(548|C)(549|I)(550|T)(551|L)(552|P)(553|Y)(554|C)(554|G)(554|N)(554|R)(554|T)(556|L)(556|S)(557|P)(557|S)(559|I)(561|*)(561|K)(562|D)(562|V)(563|S)(564|A)(565|*)(566|H)(567|*)(567|E)(569|G)(569|I)(570|C)(572|A)(573|T)(574|*)(575|G)(576|P)(577|T)(577|V)(578|G)(580|*)(580|D)(581|V)(583|S)(583|T)(587|R)(588|*)(590|D)(591|L)(592|V)(593|*)(594|A)(595|F)(595|R)(596|S)(597|A)(597|N)(598|M)(599|S)(600|S)(600|T)(600|V)(601|*)(601|R)(602|V)(603|G)(603|N)(603|Y)(605|F)(605|I)(605|L)(606|A)(606|D)(606|F)(607|G)(609|S)(609|V)(610|N)(610|Y)(611|M)(612|*)(613|H)(615|V)(616|R)(616|S)(619|*)(619|C)(621|*)(621|G)(621|L)(621|Q)(622|A)(622|L)(622|T)(623|G)(625|V)(627|N)(628|E)(628|R)(629|*)(629|R)(630|V)(631|S)(633|T)(633|V)(636|D)(636|P)(636|V)(638|G)(639|Q)(639|R)(639|Y)(640|S)(641|G)(641|Y)(642|I)(643|K)(645|E)(645|H)(646|A)(646|G)(647|*)(647|K)(647|Q)(648|N)(648|T)(648|V)(649|T)(649|V)(651|V)(652|H)(652|T)(655|I)(656|*)(656|C)(656|F)(656|H)(656|S)(658|G)(659|T)(660|E)(660|G)(662|*)(662|H)(663|I)(663|L)(663|V)(667|V)(669|A)(669|D)(669|R)(669|S)(669|V)(670|L)(671|I)(671|K)(671|Y)(672|R)(672|V)(674|A)(674|D)(674|R)(674|S)(675|A)(676|L)(676|P)(677|R)(678|H)(679|T)(680|*)(680|G)(681|E)(681|H)(682|I)(683|A)(683|R)(683|W)(687|P)(688|I)(688|R)(688|V)(690|E)(691|M)(691|T)(692|R)(692|V)(692|W)(695|L)(696|A)(696|L)(697|*)(697|F)(697|R)(697|Y)(699|*)(700|E)(701|*)(701|A)(701|K)(702|G)(703|Y)(704|T)(704|V)(706|E)(707|R)(707|S)(707|Y)(708|N)(708|V)(710|D)(710|G)(711|*)(711|Q)(713|E)(713|V)(714|V)(717|G)(717|N)(718|*)(719|W)(720|E)(721|E)(722|I)(723|F)(724|A)(724|K)(724|M)(726|I)(727|P)(727|S)(729|I)(729|V)(731|*)(732|I)(732|S)(733|T)(735|V)(736|F)(736|I)(739|T)(741|*)(742|N)(743|*)(743|L)(744|*)(747|R)(748|H)(748|Y)(749|*)(749|G)(749|K)(751|R)(753|E)(754|A)(754|S)(756|A)(756|S)(757|*)(757|S)(758|N)(758|Y)(759|*)(759|E)(761|A)(761|V)(763|V)(764|*)(764|C)(764|G)(765|T)(766|V)(767|*)(770|T)(770|V)(773|N)(774|F)(774|S)(778|*)(779|I)(782|A)(783|R)(785|P)(785|R)(788|P)(789|V)(792|S)(793|E)(793|H)(793|P)(795|Q)(796|I)(796|S)(798|D)(798|K)(798|S)(799|K)(802|A)(803|I)(804|T)(805|F)(805|V)(806|I)(807|I)(807|N)(807|S)(808|*)(809|K)(811|*)(813|I)(813|T)(813|V)(814|L)(816|*)(816|R)(820|A)(820|D)(822|*)(822|F)(824|*)(824|E)(827|R)(828|S)(829|R)(832|*)(832|D)(833|V)(834|T)(835|D)(835|H)(835|S)(839|D)(839|Q)(839|R)(840|I)(841|L)(842|V)(843|G)(843|Y)(845|E)(846|*)(846|R)(848|S)(848|T)(849|V)(851|I)(851|V)(852|*)(852|D)(852|Q)(853|A)(853|G)(854|C)(855|R)(856|*)(856|C)(856|F)(856|H)(857|V)(858|A)(858|R)(858|V)(859|*)(859|K)(860|*)(860|L)(861|*)(862|R)(864|A)(865|T)(868|A)(868|S)(869|E)(870|G)(871|N)(871|R)(872|R)(873|G)(874|*)(874|C)(874|D)(878|D)(878|Q)(879|*)(879|K)(881|Q)(883|M)(884|F)(884|S)(885|*)(886|G)(895|R)(899|I)(900|*)(902|D)(903|I)(903|S)(903|Y)(905|I)(905|R)(906|M)(906|R)(906|T)(906|V)(909|I)(909|Q)(909|R)(910|E)(910|K)(911|R)(914|*)(916|L)(917|T)(917|V)(923|E)(923|L)(924|S)(925|K)(926|M)(926|N)(928|*)(928|A)(929|*)(929|Q)(930|K)(930|M)(931|T)(933|I)(934|K)(934|M)(934|S)", expectedFormat);    }

        @Test
        public void formatComplexVariant() {

            Entry entry = Mockito.mock(Entry.class);

            PEFFVariantComplex variantComplex = new PEFFVariantComplex(entry, "NX_P43246-1");

            String expectedFormat = variantComplex.format();

            Assert.assertEquals("\\VariantComplex=(1|1|MAVQPKE)(7|7|EAVQPKE)(39|41|)(90|91|KVY)(92|92|)(94|94|)(157|157|)(175|188|)(188|190|)(191|191|)(265|314|)(287|289|)(344|344|QL)(411|426|)(417|417|VV)(440|440|)(492|493|I*)(531|537|)(596|596|)(606|606|)(732|732|)(745|746|)(746|746|II)(846|847|)(852|852|)(859|861|)(865|865|)",
                    expectedFormat);
        }
    }*/
}